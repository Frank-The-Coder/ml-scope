
# ML-Scope Architecture

## System Overview

ML-Scope is designed around a modular, real-time pipeline that integrates:
1. A **forecasting model** to generate predictions.
2. A **shared queue** for managing real-time data.
3. A **reinforcement learning agent** to process predictions and make decisions.
4. **Resilience testing** and an **experimental pipeline** for optimization.

## Core Components

### 1. Prediction Queue
- **Purpose**: Acts as the central data pipeline connecting the forecasting model and RL agent.
- **Implementation**:
  - Managed by `multiprocessing.managers.BaseManager`.
  - Supports a maximum size of 100 predictions.
- **Data Flow**:
  1. Predictions are generated by `forecast_training.py`.
  2. Predictions are enqueued with timestamps.
  3. The RL agent dequeues predictions in real-time.

### 2. Forecasting Model
- **Purpose**: Generates real-time predictions for the RL agent.
- **Architecture**:
  - LSTM model for sequence-based forecasting.
  - Configurable prediction intervals.
- **Integration**:
  - Enqueues predictions into the shared queue.
  - Logs queue status for debugging.

### 3. Reinforcement Learning Agent
- **Purpose**: Learns optimal actions based on predictions.
- **Components**:
  - `SimpleEnv`: Custom Gym environment integrating the prediction queue.
  - `QLearningAgent`: RL agent with a Q-table for learning state-action values.
- **Workflow**:
  1. Dequeues predictions from the shared queue.
  2. Takes actions based on state and prediction rewards.
  3. Updates the Q-table using a reward signal.

### 4. Resilience Testing
- **Purpose**: Evaluates system performance under high-load conditions.
- **Workflow**:
  - Rapidly enqueues predictions to simulate stress.
  - Monitors queue performance and logs delays.

### 5. Experimental Pipeline
- **Purpose**: Automates hyperparameter testing for RL agent optimization.
- **Workflow**:
  - Iteratively trains the RL agent with different hyperparameters.
  - Stops training when all predictions are processed.
  - Logs results for analysis.

## Data Flow

1. **Prediction Generation**:
   - Forecasting model generates predictions and enqueues them.
2. **Real-Time Queue Management**:
   - Queue monitors log enqueue and dequeue operations.
3. **RL Decision-Making**:
   - RL agent dequeues predictions, calculates rewards, and updates actions.
4. **Experimentation**:
   - Pipeline tests various hyperparameters to optimize RL performance.

---

## Future Enhancements
- Extend the forecasting model with advanced architectures (e.g., Transformer-based models).
- Implement a more complex reward structure for the RL agent.
- Add distributed queue management for scalability.
``` 
